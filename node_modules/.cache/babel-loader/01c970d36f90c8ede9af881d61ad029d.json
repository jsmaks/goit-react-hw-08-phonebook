{"ast":null,"code":"import _regeneratorRuntime from\"D:/GitHUB/React/goit-react-hw-08-phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/GitHUB/React/goit-react-hw-08-phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";import authActions from\"./auth-actions\";axios.default.baseURL=\"https://connections-api.herokuapp.com\";var token={set:function set(token){axios.defaults.headers.common.Authorization=\"Bearer \".concat(token);},unset:function unset(){axios.defaults.headers.common.Authorization=\"\";}};var register=function register(credentials){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(authActions.registerRequest());_context.prev=1;_context.next=4;return axios.post(\"/users/signup\",credentials);case 4:response=_context.sent;token.set(response.data.token);dispatch(authActions.registerSuccess(response.data));_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);dispatch(authActions.registerError(_context.t0.message));case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function(_x){return _ref.apply(this,arguments);};}();};var login=function login(credentials){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(authActions.loginRequest());_context2.prev=1;_context2.next=4;return axios.post(\"/users/login\",credentials);case 4:response=_context2.sent;token.set(response.data.token);dispatch(authActions.loginSuccess(response.data));_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);dispatch(authActions.loginError(_context2.t0.message));case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};var logout=function logout(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(authActions.logoutRequest());_context3.prev=1;_context3.next=4;return axios.post(\"/users/logout\");case 4:token.unset();dispatch(authActions.logoutSuccess());_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);dispatch(authActions.logoutError(_context3.t0.message));case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};var getCurrentUser=function getCurrentUser(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,getState){var _getState,persistedToken,response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_getState=getState(),persistedToken=_getState.auth.token;if(persistedToken){_context4.next=3;break;}return _context4.abrupt(\"return\");case 3:token.set(persistedToken);dispatch(authActions.getCurrentUserRequest());_context4.prev=5;_context4.next=8;return axios.get(\"/users/current\");case 8:response=_context4.sent;dispatch(authActions.getCurrentUserSuccess(response.data));_context4.next=15;break;case 12:_context4.prev=12;_context4.t0=_context4[\"catch\"](5);dispatch(authActions.getCurrentUserError(_context4.t0.message));case 15:case\"end\":return _context4.stop();}}},_callee4,null,[[5,12]]);}));return function(_x4,_x5){return _ref4.apply(this,arguments);};}();};// export default { register, logOut, login, getCurrentUser };\n// eslint-disable-next-line\nexport default{register:register,login:login,logout:logout,getCurrentUser:getCurrentUser};","map":{"version":3,"sources":["D:/GitHUB/React/goit-react-hw-08-phonebook/src/redux/auth/auth-operations.js"],"names":["axios","authActions","default","baseURL","token","set","defaults","headers","common","Authorization","unset","register","credentials","dispatch","registerRequest","post","response","data","registerSuccess","registerError","message","login","loginRequest","loginSuccess","loginError","logout","logoutRequest","logoutSuccess","logoutError","getCurrentUser","getState","persistedToken","auth","getCurrentUserRequest","get","getCurrentUserSuccess","getCurrentUserError"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport authActions from \"./auth-actions\";\r\n\r\naxios.default.baseURL = \"https://connections-api.herokuapp.com\";\r\n\r\nconst token = {\r\n  set(token) {\r\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\r\n  },\r\n  unset() {\r\n    axios.defaults.headers.common.Authorization = \"\";\r\n  },\r\n};\r\n\r\nconst register = (credentials) => async (dispatch) => {\r\n  dispatch(authActions.registerRequest());\r\n\r\n  try {\r\n    const response = await axios.post(\"/users/signup\", credentials);\r\n    token.set(response.data.token);\r\n    dispatch(authActions.registerSuccess(response.data));\r\n  } catch (error) {\r\n    dispatch(authActions.registerError(error.message));\r\n  }\r\n};\r\n\r\nconst login = (credentials) => async (dispatch) => {\r\n  dispatch(authActions.loginRequest());\r\n  try {\r\n    const response = await axios.post(\"/users/login\", credentials);\r\n\r\n    token.set(response.data.token);\r\n    dispatch(authActions.loginSuccess(response.data));\r\n  } catch (error) {\r\n    dispatch(authActions.loginError(error.message));\r\n  }\r\n};\r\nconst logout = () => async (dispatch) => {\r\n  dispatch(authActions.logoutRequest());\r\n  try {\r\n    await axios.post(\"/users/logout\");\r\n\r\n    token.unset();\r\n\r\n    dispatch(authActions.logoutSuccess());\r\n  } catch (error) {\r\n    dispatch(authActions.logoutError(error.message));\r\n  }\r\n};\r\n\r\nconst getCurrentUser = () => async (dispatch, getState) => {\r\n  const {\r\n    auth: { token: persistedToken },\r\n  } = getState();\r\n  if (!persistedToken) return;\r\n\r\n  token.set(persistedToken);\r\n  dispatch(authActions.getCurrentUserRequest());\r\n\r\n  try {\r\n    const response = await axios.get(\"/users/current\");\r\n\r\n    dispatch(authActions.getCurrentUserSuccess(response.data));\r\n  } catch (error) {\r\n    dispatch(authActions.getCurrentUserError(error.message));\r\n  }\r\n};\r\n\r\n// export default { register, logOut, login, getCurrentUser };\r\n// eslint-disable-next-line\r\nexport default { register, login, logout, getCurrentUser };\r\n"]},"metadata":{},"sourceType":"module"}